plugins {
    id 'java-library'
    id 'java-gradle-plugin'
    id 'maven-publish'
}

dependencies {
    implementation "com.android.tools.build:gradle:7.1.3"
}

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

gradlePlugin {
    plugins {
        // 插件名
        JiaguPlugin {
            // 插件 id，外部项目引用时需要
            id = 'com.zch.jiagu'
            implementationClass = 'com.zch.plugin.JiaguPlugin'
        }
    }
}

// 把插件发布到本地仓库
publishing {
    publications {
        JiaguPlugin(MavenPublication) {
            groupId 'com.zch'
            artifactId 'jiagu'
            version '0.0.1'
            from components.java
        }
    }

    // 插件存储库
    repositories {
        maven {
            // 生成的插件位置
            url = uri('../repo')
        }
    }
}